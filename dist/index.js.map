{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import { Controller } from 'stimulus'\n\nexport default class extends Controller {\n  connect() {\n    this._searchForConductor()\n  }\n\n  disconnect() {\n    this._hasConductor && this._conductorController._removeMusician(this)\n  }\n\n  _searchForConductor() {\n    const conductor = this.element.parentElement.closest(`[data-controller*=\"${this._conductorName}\"]`)\n\n    if (conductor) {\n      const conductorController = this.application.getControllerForElementAndIdentifier(conductor, this._conductorName)\n\n      this[this._conductorControllerKey] = conductorController\n\n      this._hasConductor && this._conductorController._addMusician(this)\n    }\n  }\n\n  _addMusician(musicianController) {\n    this[this._musicianControllersKey] = [\n      ...(this[this._musicianControllersKey] || []),\n      musicianController,\n    ]\n  }\n\n  _removeMusician(musicianController) {\n    const index = this._musicianControllers.indexOf(musicianController)\n\n    if (index > -1) {\n      this._musicianControllers.splice(index, 1)\n    }\n  }\n\n  get _hasConductor() {\n    return typeof this._conductorController !== 'undefined'\n  }\n\n  get _conductorControllerKey() {\n    return `${this._conductorName}Controller`\n  }\n\n  get _musicianControllersKey() {\n    return `${this._musicianName}Controllers`\n  }\n\n  get _conductorController() {\n    return this[this._conductorControllerKey]\n  }\n\n  get _musicianControllers() {\n    return this[this._musicianControllersKey]\n  }\n\n  get _conductorName() {\n    return this.constructor.conductorId || `${this.identifier}s`\n  }\n\n  get _musicianName() {\n    return this.constructor.musicianId || `${this.identifier.slice(0, this.identifier.length - 1)}`\n  }\n}\n"],"names":["_searchForConductor","_hasConductor","_conductorController","_removeMusician","conductor","element","parentElement","closest","_conductorName","conductorController","application","getControllerForElementAndIdentifier","_conductorControllerKey","_addMusician","musicianController","_musicianControllersKey","index","_musicianControllers","indexOf","splice","_musicianName","constructor","conductorId","identifier","musicianId","slice","length","Controller"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8BAGY;AACR,WAAKA,mBAAL;AACD;;;iCAEY;AACX,WAAKC,aAAL,IAAsB,KAAKC,oBAAL,CAA0BC,eAA1B,CAA0C,IAA1C,CAAtB;AACD;;;0CAEqB;AACpB,YAAMC,SAAS,GAAG,KAAKC,OAAL,CAAaC,aAAb,CAA2BC,OAA3B,CAAoC,sBAAqB,KAAKC,cAAe,IAA7E,CAAlB;;AAEA,UAAIJ,SAAJ,EAAe;AACb,cAAMK,mBAAmB,GAAG,KAAKC,WAAL,CAAiBC,oCAAjB,CAAsDP,SAAtD,EAAiE,KAAKI,cAAtE,CAA5B;AAEA,aAAK,KAAKI,uBAAV,IAAqCH,mBAArC;AAEA,aAAKR,aAAL,IAAsB,KAAKC,oBAAL,CAA0BW,YAA1B,CAAuC,IAAvC,CAAtB;AACD;AACF;;;iCAEYC,oBAAoB;AAC/B,WAAK,KAAKC,uBAAV,IAAqC,CACnC,IAAI,KAAK,KAAKA,uBAAV,KAAsC,EAA1C,CADmC,EAEnCD,kBAFmC,CAArC;AAID;;;oCAEeA,oBAAoB;AAClC,YAAME,KAAK,GAAG,KAAKC,oBAAL,CAA0BC,OAA1B,CAAkCJ,kBAAlC,CAAd;;AAEA,UAAIE,KAAK,GAAG,CAAC,CAAb,EAAgB;AACd,aAAKC,oBAAL,CAA0BE,MAA1B,CAAiCH,KAAjC,EAAwC,CAAxC;AACD;AACF;;;qBAEmB;AAClB,aAAO,OAAO,KAAKd,oBAAZ,KAAqC,WAA5C;AACD;;;qBAE6B;AAC5B,aAAQ,GAAE,KAAKM,cAAe,YAA9B;AACD;;;qBAE6B;AAC5B,aAAQ,GAAE,KAAKY,aAAc,aAA7B;AACD;;;qBAE0B;AACzB,aAAO,KAAK,KAAKR,uBAAV,CAAP;AACD;;;qBAE0B;AACzB,aAAO,KAAK,KAAKG,uBAAV,CAAP;AACD;;;qBAEoB;AACnB,aAAO,KAAKM,WAAL,CAAiBC,WAAjB,IAAiC,GAAE,KAAKC,UAAW,GAA1D;AACD;;;qBAEmB;AAClB,aAAO,KAAKF,WAAL,CAAiBG,UAAjB,IAAgC,GAAE,KAAKD,UAAL,CAAgBE,KAAhB,CAAsB,CAAtB,EAAyB,KAAKF,UAAL,CAAgBG,MAAhB,GAAyB,CAAlD,CAAqD,EAA9F;AACD;;;;EA9D0BC;;;;"}